---
title: "HW1"
author: "Esat Canli"
date: "22/04/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,fig.width=10, fig.height=6)
```

Research Question : How are exchange rates effected by the Money Supply in the economy and Interest Rates ? 


Indicators taken between (Jan-1-2010 / April 10 2020)


Exchange Rate : USD Average (Buying) - Exchange Rates
Money Supply : M1 (cash amount in the economy) aggregate - Monetary and Banking Statistics
Interest Rates: Personal Bank Loan Interest Rates from Turkish Banks - Interest Rates

All indices are taken at week ending. 


Macroeconomic Standpoint

Interest Rates & Exchange Rates: 

Higher interest rates offer lenders in an economy a higher return relative to other countries. Therefore, higher interest rates attract foreign capital and cause the exchange rate to rise. Interest and Exchange rate couple is one of the main reasons developing countries take investment from foreign countries.In developed countries, interest rates are much lower therefore it is harder to  profit from an existing capital. In times of crisis, banks lower the amount of interest rate as an incentive to borrowers (e.g COVID-19 Crisis). This usually decreases the exchange rate, meaning the foreign capital gets more valuable against the domestic currency

Money Supply & Exchange Rates

Money SUpply is usually directly controlled by the government or a Central Bank, it is usually adjusted to bring capital into the company or prevent the existing capital from leaving. When the money supply increases, usually foreign capital deposits are sold or interest rates of the central bank deposits are lowered (not personal interest rates), therefore causing foreign capital to leave the country.All else being equal, a larger money supply lowers market (not personal) interest rates, therefore decreasing the amount of foreign capital entry, resulting in an increse between the parity of the foreign currency & local currency


Altough these indices effect each other greatly in the macroeconomic theory, there are many other causes for the changes such as politics,production value,economic stability indicators and international affairs. 


Installing Neccesary Packages:
```{r Loading_Packages, message=FALSE,warning=FALSE}
require(readxl)
require(data.table)
require(zoo)
require(xts)
```

Reading Excel Files - Setting Date & Name Formats - Initial examination of the data - Interest Rates
```{r Reading Interest Rates, results="hide"}
Interest_Rates<-read_excel('Personal_Bank_Loan_Interest_Rates.xlsx',n_max=538)
Interest_Rates<-data.table(Interest_Rates)
names<-c("Date","Rate")
setnames(Interest_Rates,names(Interest_Rates),names)
Interest_Rates$Date<-as.Date(Interest_Rates$Date,format="%d-%m-%Y")
Interest_Rates$Rate<-as.numeric(Interest_Rates$Rate)
str(Interest_Rates)
```

```{r}
head(Interest_Rates)
```

```{r,echo=FALSE}
plot(Interest_Rates,main="Change of Personal Bank Loan Interest Rate Turkey  over time", xlab="Years" ,ylab="Amount of TL",pch=19,col="4",cex=0.3,frame=FALSE)
lines(lowess(Interest_Rates),col=2)
```
Figure 1 : Interest Rate in Turkey  
Comments : As it can be seen from the graph, in the last years Interest Rate variability has increased in the last years, this is mainly because of Government Policies and the recene COVID-19 incenvitves, not caused by real economy indicators.






Reading Excel Files - Setting Date & Name Formats - Initial examination of the data - Money Supply
```{r, results="hide"}
Money_Supply<-read_excel('Money_Supply_M1.xlsx',n_max=538)
Money_Supply<-data.table(Money_Supply)
str(Money_Supply)
names<-c("Date","Amount")
setnames(Money_Supply,names(Money_Supply),names)
Money_Supply$Date<-as.Date(Money_Supply$Date,format="%d-%m-%Y")
Money_Supply$Amount<-as.numeric(Money_Supply$Amount)
str(Money_Supply)
```

```{r}
head(Money_Supply)
```


```{r ,echo=FALSE}
plot(Money_Supply,main=" Money Supply in the Turkish Economy over time",xlab="Years",ylab="Amount of TL",pch=19,col="4",cex=0.3,frame=FALSE)
lines(lowess(Money_Supply),col=2)
```
Figure 2 : Money Supply Amount in Turkey  
Comments: Money supply in the economy tends to increase in developing Countries




Reading Excel Files - Setting Date & Name Formats - Initial examination of the data - Exchange Rate(USD)
```{r,results="hide"}
Exchange_Rate_USD<-read_excel('Exchange_Rate_USD.xlsx',n_max=538)
Exchange_Rate_USD<-data.table(Exchange_Rate_USD)
str(Exchange_Rate_USD)
names<-c("Date","Rate")
setnames(Exchange_Rate_USD,names(Exchange_Rate_USD),names)
Exchange_Rate_USD$Date<-as.Date(Exchange_Rate_USD$Date,format="%d-%m-%Y")
Exchange_Rate_USD$Rate<-as.numeric(Exchange_Rate_USD$Rate)
str(Exchange_Rate_USD)
```

```{r}
head(Exchange_Rate_USD)
```


```{r,echo=FALSE}
plot(Exchange_Rate_USD,main="Exchange Parity USD/TL over time",xlab="Years",ylab="USD/TL",pch=19,col="4",cex=0.3,frame=FALSE)
lines(lowess(Exchange_Rate_USD),col=2)
```
Figure 3 : Exchange Rates in Turkey  
Comments : Exchange rates are very sensitive with Government Policies, this can be seen from the peaks both in late 2019 and early 2020 in the graph, the red line is the real economy exchange parity indicator. 



```{r,fig.show='hold',out.width="50%"}
plot(Interest_Rates$Rate,Exchange_Rate_USD$Rate,main="Relationship between Interest Rate and Exchange Rate",xlab = "Interest Rate",ylab="Exchange Rate",pch=19,col="blue",cex=0.8,frame=FALSE)
plot(Money_Supply$Amount,Exchange_Rate_USD$Rate,main="Relationship between Money Supply and Exchange Rate",xlab = "Money Supply",ylab="Exchange Rate",pch=19,col="blue",cex=0.8,frame=FALSE)
```
Figure 4-5 : Interest Rate versus Exchange Rate & Money Supply versus Exchange Rate 
Comments: Correlation between the Interest Rate & Exchange Rate is not very visible but this topic will be adressed later. Money Supply and Exchange rate indicators show strong correlation in the graph, both indicators are affected by similar variables and consumer sentiment. 
  
  
  
Further Analysis:
  
  
  
Converting to xts for ease of use and taking "NA" values from the last observation. 
```{r}
Interest_Rates_xts<-xts(Interest_Rates$Rate,order.by = Interest_Rates$Date)
Interest_Rates_xts<-na.locf(Interest_Rates_xts) 

Exchange_Rate_USD_xts<-xts(Exchange_Rate_USD$Rate,order.by = Exchange_Rate_USD$Date)
Exchange_Rate_USD_xts<-na.locf(Exchange_Rate_USD_xts) 

Money_Supply_xts<-xts(Money_Supply$Amount,order.by = Money_Supply$Date)
Money_Supply_xts<-na.locf(Money_Supply_xts) 
```

  
  
  
At this point it may be meaningful to understand the variability of % indices, see if they have great variability within different time intervals. Macroeconomic theory usually makes sense in the long run. This will also show the effects of non-real-economy developments on the indices
  
  
Taking the OHLC of Exchange and Interest Rates
Money Supply OHLC does not make sense therfore not added. (it is not a parity or percentage)



Monthly OHLC
```{r}
Interest_Rate_OHLC<-to.monthly(Interest_Rates_xts)
Exchange_Rate_OHLC<-to.monthly(Exchange_Rate_USD_xts)
```

```{r,fig.show='hold',out.width="50%",echo=FALSE}
plot(Exchange_Rate_OHLC,legend.loc = "topleft",frame=FALSE)
plot.xts(Interest_Rate_OHLC,legend.loc = "topleft",frame=FALSE)
```
Figure 6-7 : Monthly OHLC of Interest and Exchange Rates  
Comments: Since the data was collected weekly, monthly variability is low since there are usually 4 values to consider. 





However, especially after 2017 yearly variability incerases due to different effects on the interest rate other than what is normal. This variability will result in the decrease of cause&effect relationship between exchange rate and interest rate later

```{r}
Interest_Rate_OHLC_yearly<-to.yearly(Interest_Rates_xts)
Exchange_Rate_OHLC_yearly<-to.yearly(Exchange_Rate_USD_xts)
```


```{r,fig.show='hold',out.width="50%",echo=FALSE}
plot.xts(Exchange_Rate_OHLC_yearly,legend.loc = "topleft",frame=FALSE)
plot.xts(Interest_Rate_OHLC_yearly,legend.loc = "topleft",frame=FALSE)
```
Figure 8-9 : Yearly OHLC of Interest and Exchange Rates  
Comments: Especially after 2017 yearly variability incerases due to different effects on the interest rate other than what is normal. This variability will result in the decrease of cause&effect relationship between exchange rate and interest rate later




Returning to the original Data Frame, It makes sense to also look at the differences and percent changes in indices



Adding differences between observations
```{r}
Interest_Rates$InterestDiff<-diff(Interest_Rates_xts,lag=1)
Exchange_Rate_USD$ExchangeDiff<-diff(Exchange_Rate_USD_xts,lag=1)
Money_Supply$AmountDiff<-diff(Money_Supply_xts)
```

Adding percent changes
```{r}
Interest_Rates$InterestChange<-100*(Interest_Rates_xts/stats::lag(Interest_Rates_xts,-1) - 1)
Exchange_Rate_USD$ExchangeChange<-100*(Exchange_Rate_USD_xts/stats::lag(Exchange_Rate_USD_xts,-1) - 1)
Money_Supply$AmountChange<-100*(Money_Supply_xts/stats::lag(Money_Supply_xts,-1) - 1)
```

Merging the data & Setting Names for convenience
```{r}
AllData<-merge(Interest_Rates,Exchange_Rate_USD,by="Date")
AllData<-merge(AllData,Money_Supply,by="Date")
setnames(AllData,"Rate.x","Interest Rate")
setnames(AllData,"Rate.y","Exchange Rate")
```


```{r,echo=FALSE}
plot(AllData[,-c("Date")],main="Relationship Between All Variables", pch=19,col="blue",cex=0.2)
```
Figure 10: Differences, Percent Changes and Real Indicators  
Comments: The correlation between the amount of money and exchange rate can be seen as from the graphs, Also the relationship between the interest rate and exhange rate seems to be close to an exponential relationship with decreasing acceleration which makes sense since the exchange rate is fixed at some point by the Central Bank when the interest rate increases too much. Also, the effect of inflation on the interest rate also changes the orientation of the graph. The changes in Interest and Exchange Rates usually converge on one line. This shows that the variables are not "directly effected" by each other. However, they closely follow each other at a lag. 




```{r,echo=FALSE}
Covariances<-as.data.frame(cor(AllData[,-c("Date")],use="complete.obs",method="pearson"))
Covariances
```
Figure 11: Correlations between the indices with Pearson Method  
Comments:Amount of Money ~  Exchange rate sits at 0.975723588 which is sensible. 
Interest Rate ~ Exchange Rate is 0.700143478. Also sensible as explained before




As we are suggesting that changes in the rate of the Money Supply and Interest Rate efffects the change in Exchange Rates, it may be helpful to plot them together to see how the change in one effects the other

Calculating Changes in Weekly Data 
```{r}
Interest_Rate_Weekly_Change<-xts(100*(Interest_Rates_xts/stats::lag(Interest_Rates_xts,-1) - 1))
Money_Supply_Weekly_Change<-xts(100*(Money_Supply_xts/stats::lag(Money_Supply_xts,-1) - 1))
Exchange_Rate_USD_Weekly_Change<-xts(100*(Exchange_Rate_USD_xts/stats::lag(Exchange_Rate_USD_xts,-1) - 1))
```

Merging the xts objects
```{r}
Interest_versus_Exchange_Change_Weekly<-merge(Interest_Rate_Weekly_Change,Exchange_Rate_USD_Weekly_Change,join="inner")
Money_versus_Exchange_Change_Weekly<-merge(Money_Supply_Weekly_Change,Exchange_Rate_USD_Weekly_Change,join="inner")
```


```{r,include=FALSE}
plot.xts(Interest_versus_Exchange_Change_Weekly,main="Weekly Interest Rate Changes and Exchange Rate Changes")
```



```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Percent Change in Interest Rate","Percent Change in Exchange Rate"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1),
          cex=0.65,
          bty="o")
```
Figure 12: Weekly Percent Changes: Interest Rate and Exchange Rates






```{r,include=FALSE}
plot.xts(Money_versus_Exchange_Change_Weekly,main="Weekly Money Amount Changes and Exchange Rate Changes")
```


```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Percent Change in Money Supply","Percent Change in Exchange Rate"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1),
          cex=0.65,
          bty="o")
```
Figure 13: Weekly Percent Changes : Money Supply and Exchange Rates

  
  
  
Weekly Data can have great variablity due to temporary oscillations, so converting the data into monthly can help identify a trend. 
  
First we seperate the xts objects into months and merge the objects on dates 
```{r}
#Seperate IR to months
ir_monthly<-endpoints(Interest_Rates_xts,on="months")
Interest_Rate_Monthly<-period.apply(Interest_Rates_xts,INDEX=ir_monthly,FUN=mean)
#Percent Change in Mean 
Interest_Rate_Monthly_Change<-xts(100*(Interest_Rate_Monthly/stats::lag(Interest_Rate_Monthly,-1) - 1))


#Seperate ER to months
er_monthly<-endpoints(Exchange_Rate_USD_xts,on="months")
Exchange_Rate_USD_monthly<-period.apply(Exchange_Rate_USD_xts,INDEX=er_monthly,FUN=mean)
#Percent Change in Mean 
Exchange_Rate_USD_Monthly_Change<-xts(100*(Exchange_Rate_USD_monthly/stats::lag(Exchange_Rate_USD_monthly,-1) - 1))


#Seperate MS to months
ms_monthly<-endpoints(Money_Supply_xts,on="months")
Money_Supply_Monthly<-period.apply(Money_Supply_xts,INDEX=ms_monthly,FUN=mean)
#Percent Change in Mean 
Money_Supply_Monthly_Change<-xts(100*(Money_Supply_Monthly/stats::lag(Money_Supply_Monthly,-1) - 1))

#Merge
Interest_versus_Exchange_Change_Monthly<-merge(Interest_Rate_Monthly_Change,Exchange_Rate_USD_Monthly_Change)
Interest_Versus_Money_Change_Monthly<-merge(Interest_Rate_Monthly_Change,Money_Supply_Monthly_Change)
Money_versus_Exchange_Change_Monthly<-merge(Money_Supply_Monthly_Change,Exchange_Rate_USD_Monthly_Change)

```









```{r,include=FALSE}
plot.xts(Interest_versus_Exchange_Change_Monthly,main="Montly Mean Change in Interest Rate versus Exchange Rate")
```

```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Percent Change in Interest Rate","Percent Change in Exchange Rate"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1),
          cex=0.65,
          bty="o")
```
Figure 14: Monthly Mean Percentage Change in : Interest Rates and Exchange Rates  
Comments: From the graph, Interest rate changes and Exchange rate changes is seen to move against each other with a time lag in between, this time lag can be identified as the consumer reaction time. 




```{r,include=FALSE}
plot.xts(Money_versus_Exchange_Change_Monthly,main="Monthly Mean Change in Money Supply versus Exchange Rate")
```

```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Mean Percent Change in Money Supply","Mean Percent Change in Exchange Rate"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1),
          cex=0.65,
          bty="o")
```
Figure 15: Monthly Mean Percentage Change in : Money Supply and Exchange Rates  
Comments: From the graph, Trends can be identified as the Exchange rate Change rapidly follows once the Money Supply decreases however the reaction amount is usually not the same, this is mainly because the exchange rate is highly sensitive towards consumer sentiment and can be highly effected by overall behaviours, trends of panic can be identified from the graph where the Money Supply shows an upper trend. There is also a lag simillar to the previous graph 










Also, Looking at the percent changes in difference at lag=1(weekly) can help since the value of indices can have great variability over the week but the differences can help bring down the variability by showing the peak times. These graphs can show the panic times of consumers where there is a great change in 1 lag once the dependent index decreases/increases. 

```{r}
Exchange_Rate_USD_Weekly_Diff_Change<-xts(diff(100*(Exchange_Rate_USD_xts/stats::lag(Exchange_Rate_USD_xts,-1) - 1)))
Interest_Rate_Weekly_Diff_Change<-xts(diff(100*(Interest_Rates_xts/stats::lag(Interest_Rates_xts,-1) - 1)))
Money_Supply_Weekly_Diff_Change<-xts(diff(100*(Money_Supply_xts/stats::lag(Money_Supply_xts,-1) - 1)))

```


```{r}
Interest_Rate_versus_Exchange_Weekly_Diff_Change<-merge(Exchange_Rate_USD_Weekly_Diff_Change,Interest_Rate_Weekly_Diff_Change,join="inner")
Money_versus_Exchange_Change_Weekly_Diff_Change<-merge(Exchange_Rate_USD_Weekly_Diff_Change,Money_Supply_Weekly_Diff_Change,join="inner")
```






```{r,include=FALSE}
plot(Interest_Rate_versus_Exchange_Weekly_Diff_Change,main="Weekly Percent Changes in Interest Rate and Exchange Rate")
```

```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Weekly Percent Change in Differences of Exchange Rates","Weekly Percent Change in Differences of Interest Rates"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1), 
          cex=0.65,
          bty="o")
```
Figure 16:Percent Change Differences : Interest Rate and Exchange Rate



```{r,include=FALSE}
plot.xts(Money_versus_Exchange_Change_Weekly_Diff_Change)
```

```{r,echo=FALSE}
addLegend(legend.loc = "topleft",
          legend.names =c("Weekly Percent Change in Differences of Exchange Rates","Weekly Percent Changes in Money Supply Amounts"),
          col=c("red","black"),
          lty=c(1,1), 
          lwd=c(1,1),
          cex=0.65,
          bty="o")
```
Figure 17:Percent Change Differences : Money Supply and Exchange Rate



Conclusion:


Since the indices are taken from a period of 10 years, macroeconomic theory does not strictly follow immediate reactions as previously explained.Also, the indicators taken are simplified for better use, Interest Rates are taken as the personal bank loan rates, Exchange Rates are taken from USD/TL currency and the money supply is taken from M1 - omitting M2 & M3 which both have effects on the real index of Exchange Rates-  However; correlations between the indices and the trends in the percent changes in 3 variables shows a medium to strong relationship between Interest Rates, Exchange Rates and Money Supply in the economy. Also, the lag between the index changes also helps identify the consumer reaction times and regulatory government interventions. Panic  behaviour of consumers can also seen from some of the graphs,since when the Exchange Rates rises consumers are inclined to withdraw money from deposits therefore increasing the Money Supply.Forecasting real economy indicators from historic data may not be very sensible, however it is helpful to identify the increasing trends in indices.A comprehensive study in this subject should include all real variables such as GDP,CPI,PPI. Altough even with these variables it is hard to identify trends in the real economy indicators since they are very sensitive to Government Regulations,International affairs and Politics as well as consumer sentiments.



